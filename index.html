<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Vybr Web</title>
    <meta name="description" content="Lovable Generated Project" />
    <meta name="author" content="Lovable" />
    <meta property="og:image" content="/og-image.png" />
    <!-- Content Security Policy - Allow ngrok and external resources for Apple Music -->
    <meta http-equiv="Content-Security-Policy" content="default-src 'self' 'unsafe-inline' 'unsafe-eval' data: blob: https: http:; font-src 'self' data: https: http:; img-src 'self' data: blob: https: http:; script-src 'self' 'unsafe-inline' 'unsafe-eval' https://cdn.gpteng.co https://js-cdn.music.apple.com https:; style-src 'self' 'unsafe-inline' https:; connect-src 'self' https: http: ws: wss:;">
  </head>

          <body>
            <div id="root"></div>
            <!-- Setup polyfills for MusicKit BEFORE loading it -->
            <script>
              console.log('[HTML] Setting up MusicKit polyfills...');
              
              // Add module polyfills for MusicKit's CommonJS dependencies
              window.module = { exports: {} };
              window.exports = window.module.exports;
              window.global = window;
              
              // Add process polyfill
              window.process = {
                env: {},
                version: '',
                versions: { node: '16.0.0' },
                platform: 'browser',
                browser: true,
                nextTick: function(fn) { setTimeout(fn, 0); },
                cwd: function() { return '/'; },
                chdir: function() {},
                umask: function() { return 0; }
              };
              
              // Mock require
              window.require = function(module) {
                console.log('[HTML] Mock require:', module);
                return {};
              };
              window.require.resolve = function(module) { return module; };
              
              console.log('[HTML] Polyfills ready');
            </script>
            <!-- Load MusicKit JS after polyfills -->
            <script src="https://js-cdn.music.apple.com/musickit/v1/musickit.js" crossorigin="anonymous"></script>
            <script>
              // Verify MusicKit loaded
              console.log('[HTML] MusicKit loaded:', typeof window.MusicKit !== 'undefined');
              if (window.MusicKit) {
                console.log('[HTML] MusicKit.configure exists:', typeof window.MusicKit.configure === 'function');
              } else {
                console.error('[HTML] MusicKit failed to load!');
              }
            </script>
            <!-- IMPORTANT: DO NOT REMOVE THIS SCRIPT TAG OR THIS VERY COMMENT! -->
            <script src="https://cdn.gpteng.co/gptengineer.js" type="module"></script>
            <script type="module" src="/src/main.tsx"></script>
          </body>
</html>
